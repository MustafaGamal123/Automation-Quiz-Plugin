<?xml version="1.0" encoding="UTF-8"?>
<XMLDB PATH="mod/quiz/accessrule/proctoring/db" VERSION="20250826" COMMENT="XMLDB file for Moodle mod/quiz/accessrule/proctoring - Compatible with Moodle 5.0.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../../../../lib/xmldb/xmldb.xsd">
  <TABLES>
    <TABLE NAME="quizaccess_proctoring" COMMENT="Stores all the settings for this accessrule">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true"/>
        <FIELD NAME="quizid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="Foreign key related to quiz.id."/>
        <FIELD NAME="proctoringrequired" TYPE="int" LENGTH="2" NOTNULL="true" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="If 1 then the quiz require identity validation."/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="quizid" TYPE="foreign-unique" FIELDS="quizid" REFTABLE="quiz" REFFIELDS="id"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="quizaccess_proctoring_logs" COMMENT="Stores all validations for reporting">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true"/>
        <FIELD NAME="courseid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="Course id."/>
        <FIELD NAME="quizid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="Quiz id"/>
        <FIELD NAME="userid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="User who validate identity"/>
        <FIELD NAME="webcampicture" TYPE="text" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="Webcam photo used for validation purposes"/>
        <FIELD NAME="status" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="false" COMMENT="Validation process status"/>
        <FIELD NAME="awsscore" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="AWS image match score"/>
        <FIELD NAME="awsflag" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="AWS image match flag"/>
        <FIELD NAME="deletionprogress" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="Progress of deletion process"/>
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="false" COMMENT="Validation process date and time"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="courseid" UNIQUE="false" FIELDS="courseid"/>
        <INDEX NAME="quizid" UNIQUE="false" FIELDS="quizid"/>
        <INDEX NAME="userid" UNIQUE="false" FIELDS="userid"/>
      </INDEXES>
    </TABLE>
    <TABLE NAME="quizaccess_proctoring_facematch_task" COMMENT="Stores check face recognition task logs">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true"/>
        <FIELD NAME="refimageurl" TYPE="text" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="Reference image url"/>
        <FIELD NAME="targetimageurl" TYPE="text" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="Target image url"/>
        <FIELD NAME="reportid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="Report id"/>
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="false" COMMENT="Validation process date and time"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="reportid" UNIQUE="false" FIELDS="reportid"/>
      </INDEXES>
    </TABLE>
    <TABLE NAME="quizaccess_proctoring_fm_warnings" COMMENT="Stores face mismatch warnings">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true"/>
        <FIELD NAME="reportid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="Report id"/>
        <FIELD NAME="courseid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="Course id"/>
        <FIELD NAME="quizid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="Quiz id"/>
        <FIELD NAME="userid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="User id"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="reportid" UNIQUE="false" FIELDS="reportid"/>
        <INDEX NAME="courseid" UNIQUE="false" FIELDS="courseid"/>
        <INDEX NAME="quizid" UNIQUE="false" FIELDS="quizid"/>
        <INDEX NAME="userid" UNIQUE="false" FIELDS="userid"/>
      </INDEXES>
    </TABLE>
    <TABLE NAME="quizaccess_proctoring_user_images" COMMENT="Each record is a data of specific user">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true"/>
        <FIELD NAME="user_id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="User ID"/>
        <FIELD NAME="photo_draft_id" TYPE="int" LENGTH="20" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="Photo draft ID"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="user_id" UNIQUE="false" FIELDS="user_id"/>
      </INDEXES>
    </TABLE>
    <TABLE NAME="quizaccess_proctoring_face_images" COMMENT="Each record is a data of specific Images">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true"/>
        <FIELD NAME="parent_type" TYPE="char" LENGTH="20" NOTNULL="true" DEFAULT="1" SEQUENCE="false" COMMENT="Foreign key for quizaccess_proctoring_logs table or proctoring_user_images table"/>
        <FIELD NAME="parentid" TYPE="int" LENGTH="20" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="Parent record ID"/>
        <FIELD NAME="faceimage" TYPE="text" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="Face photo used for validation purposes"/>
        <FIELD NAME="facefound" TYPE="char" LENGTH="2" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Face detection flag"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="parentid" UNIQUE="false" FIELDS="parentid"/>
        <INDEX NAME="parent_type" UNIQUE="false" FIELDS="parent_type"/>
      </INDEXES>
    </TABLE>
  <TABLE NAME="quizaccess_proctoring_suspicious_images" COMMENT="Stores suspicious images detected during proctoring">
    <FIELDS>
      <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true"/>
      <FIELD NAME="reportid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
      <FIELD NAME="courseid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
      <FIELD NAME="quizid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
      <FIELD NAME="userid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
      <FIELD NAME="suspicion_type" TYPE="char" LENGTH="20" NOTNULL="true" DEFAULT=""/>
      <FIELD NAME="image_data" TYPE="text" NOTNULL="true" SEQUENCE="false"/>
      <FIELD NAME="filename" TYPE="char" LENGTH="255" NOTNULL="true" DEFAULT=""/>
      <FIELD NAME="filepath" TYPE="char" LENGTH="500" NOTNULL="true" DEFAULT=""/>
      <FIELD NAME="filesize" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0"/>
      <FIELD NAME="flagged" TYPE="int" LENGTH="2" NOTNULL="true" DEFAULT="0"/>
      <FIELD NAME="note" TYPE="text" SEQUENCE="false"/>
      <FIELD NAME="flag_timestamp" TYPE="int" LENGTH="10" UNSIGNED="true" SEQUENCE="false"/>
      <FIELD NAME="flag_user_id" TYPE="int" LENGTH="10" SEQUENCE="false"/>
      <FIELD NAME="ip_address" TYPE="char" LENGTH="45" NOTNULL="true" DEFAULT=""/>
      <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="false"/>
    </FIELDS>
    <KEYS>
      <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
    </KEYS>
  </TABLE>
  </TABLES>
</XMLDB>